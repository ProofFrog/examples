import 'examples/HPKE/KDF/KDF.primitive';

// KDF is modelled as a random oracle

Scheme RandomKDF(Int out) extends KDF {
    Int out = out;
    Map<BitString * BitString, BitString<out>> L;

    BitString<out> evaluate(BitString ikm, BitString info) {
        BitString<out> k <- BitString<out>;
        if ([ikm, info] in L) {
            k = L[[ikm, info]];
        } else {
            L[[ikm, info]] = k;
        }
        return k;
    }
}
